<?php


/* VARAIBLES GLOBALES */




function copy_file($anio, $mes)
{
    $nombre_arch = 'INFORME_COMPRAS_VENTAS_MES';
    $ext_arch = 'pdf';
    $ruta = '/var/www/html/modulo_plan/informes/pdf/';
    $destino = '/var/www/html/modulo_odoo/Informes/pdf/';
    $archivos = glob($ruta . $nombre_arch . '.*');
    // $archivos= glob($ruta.$nombre_arch.'_'. $anio.'_'.$mes. '.*');
    // $archivos= glob($ruta.'.'.$nombre_arch.'_'.$anio.'_'.$mes.'.'. $ext_archa);
    foreach ($archivos as $archivo) {
        $archivo_copiar = str_replace($ruta, $destino, $archivo . '_' . $anio . '_' . $mes);
        $archivo_copiar = str_replace('.pdf', '', $archivo_copiar);
        copy($archivo, $archivo_copiar . '.' . $ext_arch);
    }
}
function fun_conectar_sqlserv($name_db)
{
    $server_name = '192.168.6.15';
    $user_name = 'sa';
    $user_pass = '%19Sis60Tem@s17';
    $cLink = mssql_connect($server_name, $user_name, $user_pass) or die(mssql_get_last_message());
    mssql_select_db($name_db, $cLink);
    if (!$cLink) {
        echo "sin conectar a l server";
    } else {
        echo 'Conectado';
    }
}


function id_periodo()
{

    $sql_periodo = mssql_query("
            select 
                distinct top 6 codigo
                ,nombre
                ,fechaini
                ,fechafin
            from 
                sqlFacturas.dbo.agrPeriodo 
            order by 
                codigo desc");
    echo '
    Periodo:
    <select name="Por_Fechas" id="Por_Fechas" style="width:100%;" onchange="validar_rango(this.value);">
        <option value="Por_Fechas">por_fechas</option>    
    ';
    while ($period = mssql_fetch_array($sql_periodo)) {
        echo '<option value="' . $period['codigo'] . '">' . $period['nombre'] . '</option>';
    }
    echo '
    </select>
    ';
}


function rangos_fechas($status = 0)
{
    // if($_POST['lsPeriodo']=='selected' || $_POST['lsPeriodo']=='Por_Fechas'){
    if ($status == 0) {
        echo '
				<div id="ocultarPeriodo" name="ocultarPeriodo"  class="div_rangos">
                    <td>
                        Desde:<br> <input id="desde" name="desde" class="frm campo Aabs" value="' . obtener_fechas_desde(2) . '" type="date"><br>
                    </td>
                    <td>
                        Hasta:<br> <input id="hasta" name="hasta" class="frm campo Aabs" value="' . obtener_fechas_desde(1) . '" type="date"><br>
                    </td>
				</div>
				';
    } else {
        echo '
				<div id="ocultarPeriodo" name="ocultarPeriodo" style="display: none" class="div_rangos">
                    <td>
                        Desde:<br> <input id="desde" name="desde" class="frm campo Aabs" value="' . obtener_fechas_desde(2) . '" type="date"><br>
                    </td>    
                    <td>
                        Hasta:<br> <input id="hasta" name="hasta" class="frm campo Aabs" value="' . obtener_fechas_desde(1) . '" type="date"><br>
                    </td>    
				</div>
				';
    }
}

function obtener_fechas_desde($dato)
{
    $anio_actual     = date("Y");
    $mes_actual      = date("m");
    $hoy_ibs         = date("Ymd");
    $hoy             = date("Y-m-d");
    $hoy_2_sem       = date("Y-m-d", strtotime("$hoy + 2 week"));
    $hoy_menos_mes   = date("Y-m-d", strtotime("$hoy - 1 month"));
    $manana          = date("Y-m-d", strtotime("$hoy + 1 day"));





    if ($dato == 1) {
        $date = $hoy;
    } else if ($dato == 2) {
        $date = $hoy_menos_mes;
    } else {
        $date = $hoy;
    }




    return $date;
}
